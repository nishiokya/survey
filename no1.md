# 論文情報・リンク
論文リンク： https://ai.stanford.edu/~ronnyk/2009controlledExperimentsOnTheWebSurvey.pdf
公開日時： Published online: 30 July 2008; Journal issue: February 2009 ￼ ￼
実装コード： 内部実装プラットフォーム「ExP」（Microsoft内部・非公開）を紹介 ￼
Publication : Data Mining and Knowledge Discovery, Vol. 18, No. 1, pp. 140–181 (2009) ￼

# Abstract

制御実験（ランダム化実験、A/Bテストおよびその拡張、スプリットテスト、Control/Treatmentテスト、多変量テスト（MVT）、並行フライトとも呼ばれる）は、変更とユーザーの観察可能な行動への因果関係を確立するための、最も理にかなった科学的デザインを体現しています。本稿では、エンドユーザーの反応を活かして機能開発を導くオンライン実験の実践的ガイドを提供します。私たちの経験から、開発チームが「Highest Paid Person’s Opinion（HiPPO）」ではなく顧客の声に耳を傾けることで、大きな学びと投資収益率（ROI）が得られることが明らかになっています。

本稿では、驚くべき結果をもたらしたいくつかの制御実験事例を紹介するとともに、実験を実行する上で必要な重要要素と、その技術的・組織的な制約について論じます。特に、統計的検出力、サンプルサイズ、分散削減のための手法といった、実験設計における要所に焦点を当てています。

また、実験システムの一般的なアーキテクチャを説明し、それぞれの利点・欠点を分析します。さらに、実際には単純とは言えないランダム化およびハッシュ化技術についても評価を行います。

制御実験は通常、大量のデータを生み出しますが、これをデータマイニング技術で分析することで、結果に影響を与える要因を深く理解し、新たな仮説を生み出し、改善の好循環を生み出せます。明確な評価基準のもとで制御実験を取り入れる組織は、自動最適化やリアルタイム分析を通じてシステムを継続的に進化させることが可能です。

私たちは複数のシステムや組織での豊富な実践経験に基づき、信頼性の高い制御実験を実施するための重要な教訓を本稿で共有します。


# 1 Introduction
「千の専門家の意見に勝るは、一つの正確な測定である」
― アドミラル・グレース・ホッパー
1700年代、ある英国海軍の船長は、地中海方面の艦隊に配属された水兵が壊血病（スコルブ）の症状をほとんど示さないことに気づきました。彼らの配給食には柑橘類が含まれていたのです。そこで船長は乗組員を二つのグループに分け、一方（Treatment 群）にはライムを与え、もう一方（Control 群）には従来通りの食事を続けさせる実験を行いました。Treatment 群では不満の声も上がりましたが、実験は成功し、ライムの摂取が壊血病の予防に効果的であることが示されました。船長自身は壊血病がビタミンC欠乏によるものであることや、ライムに豊富にビタミンCが含まれていることを理解していませんでしたが、この介入は確実に功を奏しました。やがて英国水兵には定期的に柑橘類を摂取することが義務づけられ、その習慣が「ライミーズ（limeys）」という愛称を生むに至りました（Rossi et al. 2003; Marks 2000）。

それから約300年後、Amazon のグレッグ・リンデンは、ショッピングカートに入れた商品の履歴に応じてパーソナライズされた推薦を表示するプロトタイプを開発しました（Linden 2006a, b）。商品を一つ追加すると推薦が現れ、別の商品を追加すると別の推薦が表示される仕組みです。このアイデアは一見有望でしたが、あるマーケティング上級副社長は「チェックアウトの妨げになる」と断固反対し、リンデンは「これ以上手をつけるな」と命じられました。しかし、彼はそれでも制御実験を実施し、その機能は圧倒的な差で勝利を収め、「未導入のままでいることが Amazon にかなりの損失を与えている」ことが明らかになりました。急遽ショッピングカート推薦機能が本番導入され、その後、多くのサイトが同様の仕組みを採用しています。

本論文の著者たちは、Amazon、Microsoft、DuPont、NASA などで数多くの実験に携わってきました。特に Amazon では「直感よりデータを重視する」という文化と、実験を容易に行えるシステムが整備されており、迅速かつ効果的なイノベーションを可能にしています。Microsoft においても複数の制御実験システムが運用されており、本論文ではそれぞれのアーキテクチャの利点と欠点を解説します。本稿の一貫したテーマは、制御実験が優れた投資収益率（ROI）を生み出し、適切なインフラストラクチャを構築することでイノベーションのスピードを加速できるという点です。Stefan Thomke の著書『Experimentation Matters』（Thomke 2003）のタイトルは、その趣旨を端的に示しています。

Webは、制御実験（ランダム化実験：単因子設計または因子設計）、A/Bテスト（およびその一般化）、スプリットテスト、Control/Treatmentテスト、並行フライトといった手法を用いて、アイデアを迅速に評価するための前例のない機会を提供します。これらの実験の最もシンプルな形では、実際のユーザーをランダムに二つのバリアントのいずれかに割り当てます。(i) Control（通常は「既存」バージョン）、(ii) Treatment（評価対象となる新バージョン）です。実行時パフォーマンスから、暗黙的・明示的ユーザー行動、アンケートデータまで、多様な指標を収集し、統計検定を適用して、両バリアント間に有意差があるかどうかを判断します。これにより、「バージョン間に差はない」という帰無仮説を維持するか棄却するかを決定できます。さらに、OLAPなどの手動分析や機械学習・データマイニング技術によってユーザーセグメントを掘り下げることで、どのサブポピュレーションにおいて差が顕著かを明らかにし、アイデア理解を深め、次のステップへ進む助けとします。

制御実験は、アイデアを確実に評価するための方法論を提供します。事後分析や中断時系列分析（準実験法）などとは異なり、本手法は因果関係を検証するための実験デザインです（Keppel et al. 1992, pp. 5–6）。多くの組織には多彩なアイデアがありますが、そのROI（投資収益率）が不明瞭だったり、評価コストが高かったりします。しかし次節で示すように、わずかな変更が大きな違いを生むことがあり、その結果はしばしば予測を超えます。本番環境での実験は、アイデアの価値を見極めるうえで強力な指針を与えてくれます。

本稿の貢献は以下のとおりです。
- 第3節では、Web環境における制御実験の概要をレビューし、統計的検出力やサンプルサイズといった、初学者向け解説ではしばしば省略されがちな重要項目を含む豊富な文献を紹介します。さらに実務で有効だった分散削減手法、実践上の拡張・制約も論じ、実務者が陥りやすい落とし穴を回避できるようにします。
- 第4節では、オンライン環境における多変量テスト（MVT）の代替策を複数提示します。ソフトウェア領域では、従来型MVTよりも並行した一因子テストのほうが適している場合がある理由を論じます。
- 第5節では、著者が関与してきた複数の実験システムを統合する汎用アーキテクチャを示し、その長所と短所を比較します。また、実際には統計的妥当性を担保する条件付き独立性テストに通らないランダム化・ハッシュ化スキームが存在することを明らかにします。
-第6節では、実務で得られた重要な教訓を共有します。

企業が実験基盤を構築すれば、テストコストや実験失敗のダメージは小さくなり、実験によるイノベーションが促進されます。「早く失敗する」ことで、アイデアの有効性を迅速に見極め、より成功し得る次のアイデアへと舵を切ることが可能になるのです。
