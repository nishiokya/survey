
論文情報・リンク
論文リンク：[ https://ai.stanford.edu/~ronnyk/2009controlledExperimentsOnTheWebSurvey.pdf ](https://arxiv.org/pdf/2012.08724)



# Abstract

オンライン実験（A/Bテストとも呼ばれる）は、テック業界において製品の影響を測定し、ビジネス上の意思決定を行うためのゴールドスタンダードである。
しかし、実験の妥当性と有用性は、不偏性と十分な検出力にかかっている。
二面型のオンライン・マーケットプレイスでは、これら双方の要件が疑問視される。
ベルヌーイ無作為化実験では、市場競争を通じて処置群のユニットが対照群のユニットに干渉するためバイアスが生じ、「安定単位処置値仮定（SUTVA）」に違反する。
さらに市場の少なくとも一方では、両サイドのサンプルサイズの不均衡により、しばしば検出力が不足する。オンライン経済におけるマーケットプレイスの重要性と、製品改善における実験の決定的な役割にもかかわらず、
マーケットプレイス実験におけるこのバイアスと低検出力の問題に対する有効かつ実用的な解決策は欠けていた。
本論文は、買い手が有限でも無限でもよい「定義された予算」を持つあらゆるマーケットプレイスにおいて不偏となる実験デザインを提案することで、このギャップを埋める。
次に、このデザインをオンライン・マーケットプレイスにデプロイするための一般化可能なシステム・アーキテクチャを提示する。
最後に、実世界の二つのオンライン・マーケットプレイスで実施した実験から得られた実証的なパフォーマンスにより、我々の所見を確認する。

# 1 Introduction

オンライン実験（A/Bテストとも呼ばれる）は、テック業界において製品インパクトを測定し、ビジネス上の意思決定を行うためのゴールドスタンダードとなっている。Google、Facebook、Amazon、Microsoft、LinkedIn といった企業はこのパラダイムを受け入れ、大規模なオンライン実験を可能にする社内プラットフォームを構築してきた（Tang et al., 2010; Letham et al., 2019; Deng and Shi, 2016; Kohavi et al., 2012; Xu et al., 2015）。さらに、より広いユーザーに「実験 as a service」を提供する商用プラットフォームも登場している（Johari et al., 2017）。オンライン実験が意思決定に果たす重要な役割と、それがビジネスに与える大規模な影響を踏まえると、実験の**不偏性（bias の無さ）と検出力（power）**を確保することは極めて重要である。

実験にバイアスがあると、効果推定値は体系的に誤り、ビジネス意思決定の質が損なわれる。これは、バイアスが体系的である場合には特に有害である。実験に十分な検出力がないと、大きな影響であっても統計的に有意とならず「中立」と誤って見なされてしまう。また、影響が検出できたとしても、実験のスループット、ひいてはイノベーションの速度が制限される。こうした理由から、オンライン実験に関する文献の大半は、干渉構造の下で不偏な実験を設計すること（Saveski et al., 2017; Eckles et al., 2017）、もしくは不偏な実験の検出力を高めること（Deng et al., 2013）のいずれかに費やされてきた。

不偏でかつ高い検出力を持つ実験を設計する最適戦略は、基礎となる干渉（interference）の構造に強く依存する。テック業界で最も研究されてきた干渉の例はオンライン・ソーシャルネットワークである（Saveski et al., 2017; Eckles et al., 2017）。そこでは、各ユニットは同一タイプのエンティティ（例：SNSのメンバー）であり、互いに接続し、その接続を通じて相互作用する。

一方、オンライン・プラットフォームでもう一つ重要でありながら十分に扱われてこなかった干渉構造がオンライン・マーケットプレイスである。ソーシャルネットワークと異なり、マーケットプレイスの母集団は少なくとも2種類のユニット――商品・サービス・注目（attention）を提供する売り手と、ある通貨でそれらを購入する買い手――からなる。マーケットプレイスはオンライン経済の重要な一部であり、しばしばテック企業における収益の源泉である。そのため、テック企業とオンライン経済の健全性の双方にとって、オンライン・マーケットプレイスで不偏かつ高い検出力をもって実験できることが重要である。オンライン・マーケットプレイスの例としては、広告主がプラットフォーム会員の注意を広告インプレッションとして購入する広告マーケットプレイス（McMahan et al., 2013; He et al., 2014）、雇用者が求職者の注意を求人掲載として購入する採用マーケットプレイス、教育プラットフォームで買い手が教育者からコースを購入するケースなどがある。

オンライン・マーケットプレイスにおける干渉やネットワーク構造は、不偏性と検出力の双方に対して実験上の課題をもたらす。売り手側または買い手側でのベルヌーイ無作為化実験は「安定単位処置値仮定（SUTVA）」（Rubin, 2005; Johari et al., 2020）に違反し、バイアスを生む。SUTVA がなぜ破られるのかを示すために、売り手側のベルヌーイ無作為化実験を例にとる。もし処置が売り手の競争力を高めるなら、すべての買い手が依然として十分な予算の余力を持ってより多く購入できるのでない限り、処置群の売り手の魅力度の上昇は、相対的に対照群の売り手の魅力度の低下に結びつき、処置側の売上が増えるほど対照側の売上が減少する。マーケットプレイスにおけるこの種の干渉は、各ユニットの潜在アウトカムは自分が受けた処置のみに依存し、他ユニットが受けた処置には依存しないとする SUTVA に反する。同様の議論は、買い手側のベルヌーイ無作為化実験も SUTVA に違反し、バイアスを生むことを説明する。マーケティング領域では、このバイアスは**「カニバリゼーション・バイアス」と呼ばれる。これは、総売上が成長したからではなく、処置側の売上が対照側の売上を食って増えていることを強調する呼び名である。カニバリゼーションが存在する状況でベルヌーイ無作為化実験に基づいて意思決定を行うと、処置効果が体系的に過大評価**される。現実のあらゆるマーケットプレイスでは、買い手の予算や売り手の在庫には常に制約があるため、売り手側・買い手側いずれのベルヌーイ無作為化実験もこのカニバリゼーション・バイアスの影響を受ける。

カニバリゼーション・バイアスに加えて、マーケットプレイス実験は検出力不足にも悩まされる。これは、市場の二つの側面が通常異なるタイプのエンティティから成り、数の規模が大きく異なるために生じる。たとえば広告マーケットプレイスでは、買い手が企業広告主や代理店、売り手が一般ユーザーであるため、買い手の数は売り手の数より3桁小さいことがある（Lara O’Reilly, 2015; WebsiteBuilder, 2020）。同様に、物理商品のマーケットプレイスでは、買い手は消費者、売り手は中小事業者であることが多く、買い手の数は売り手の数より60倍多い（Emily Dayton, 2019）。このサンプルサイズの非対称は、そのまま実験の検出力の非対称に結びつく。さらに、サンプルが小さい側の指標分布に厚い裾（ロングテール）があると、この検出力不足は一層深刻化する。市場の一方で相対的に検出力が不足する、すなわちパワーの非対称が生じることは望ましくない。マーケットプレイス・ビジネスは両側を継続的に最適化してはじめて持続可能であり、一方の側の実験検出力が著しく低いということは、その側のイノベーションや最適化の速度が絞られてしまうからである。

既存文献のマーケットプレイス実験に対する解決策は、おおまかに二つのアプローチに分類できる。第一は分析アプローチで、干渉構造とカニバリゼーション・バイアスをまずモデル化し、バイアスのあるベルヌーイ無作為化実験にモデルベースの補正を施す（Johari et al., 2020; Blake and Coey, 2014）。第二は設計アプローチで、マーケットプレイスに関する弱く検証可能な仮定の下で不偏となる代替デザインを探る（Bojinov and Shephard, 2019; Jason (Xiao) Wang, 2018; Basse et al., 2016a）。分析アプローチでは、通常まずマーケットプレイスをパラメトリックなモデルに単純化する必要があり、そのモデリング仮定自体はしばしば検証不能である。実際、もしモデルがマーケットプレイスを正確に捉えられるなら、実験は不要で、処置効果はシミュレーションで測定できるはずである。いくつかの設計アプローチ（Bojinov and Shephard, 2019; Jason (Xiao) Wang, 2018）は、妥当な仮定の下で低バイアスを達成しているが、その低バイアスはしばしばより低い検出力という代償を伴う。

本論文は、budget-split（予算分割）デザインを提案することで、こうしたバイアスと検出力の両課題を克服し、マーケットプレイス実験の文献に貢献する。budget-split デザインが不偏であるために必要なのは、買い手が連続的な予算（有限でも無限でもよい）を持つという、検証が容易な仮定が一つだけである。現実世界のマーケットプレイスに展開した場合、代替デザインと比べて最大30倍の検出力を示す。さらに、このデザインの実装とデプロイには、既存のオンライン・マーケットプレイス基盤や実験プラットフォームの全面刷新は不要であり、各モジュールへの増分的な変更だけで済む。

我々のデザインは、Basse et al. (2016a) の budget allocation デザインといくつかの類似点を共有するが、両者は本質的に異なる。Basse et al. (2016a) では、各買い手に間接的で人工的な「予算」（クォータ）を付与するのに対し、budget-split デザインは買い手が定義する直接的かつ自然な予算を扱う。また、Greg Novak and Spiegel (2020) のブログ投稿には、budget-split の在庫分割（inventory-split）版に相当する設計が概説されていることも付記しておく。我々が提示する budget-split デザインの形式的解析は、小改変でこの在庫分割設定にも直接適用可能である。

budget-split デザインのインパクトは大きい。これは、カニバリゼーション・バイアスのないマーケットプレイス実験を可能にし、従来ならノイズに埋もれていた処置効果の検出力を押し上げた。その結果、マーケットプレイスにおけるイノベーションと最適化は、はるかに高い確信度と速度で実施できるようになった。本稿では、広告マーケットプレイスを通例の例として、budget-split デザインを提示する。方法論、システム・アーキテクチャ、そして実証結果は、買い手が明確な予算を持つ任意のマーケットプレイス（たとえば採用マーケットプレイス）に容易に拡張できる。

本論文の構成は次のとおりである。第2節では、潜在アウトカム枠組みを用いてマーケットプレイスにおける因果推論の問題を形式的に定義する。第3節では、budget-split デザインを導入し、クラスター無作為化や隔日（alternating-day）デザインといった代替デザインとの対比を行う。第4節では、オンライン・マーケットプレイスに budget-split デザインをデプロイする際のシステム・アーキテクチャと実装上の要点を述べる。第5節では、budget-split デザインの不偏性と検出力に関する実証結果を報告する。最後に第6節で、議論と今後の研究課題を述べて結ぶ。

# 2 Experimentation in online ads marketplace
オンライン広告マーケットプレイス（OAM）における実験は、二部グラフ上で行われる二部実験の系に属する。ここでは二種類のエンティティ――買い手と売り手――を結ぶ二部グラフ上で実験が行われる（Pouget-Abadie et al., 2019; Doudchenko et al., 2020）。売り手はサイトを訪れる消費者メンバーであり、自らの注意（attention）を提供し、広告インプレッションに対するリクエストを生成する。一方、買い手は広告主で、これらのリクエストを広告インプレッションで満たす。各メンバーの訪問は、複数の広告リクエストの「販売」につながり得る（すなわち、1回の訪問中にページ上に複数の広告枠がある場合がある）。各広告主は、目的の異なる複数のキャンペーンを作成でき、キャンペーンごとに異なる予算を持ち、異なるメンバーセグメントをターゲティングする。

一般性を失うことなく、市場の両サイドにおける実験ユニットをメンバーとキャンペーンに設定する。本フレームワークは他の粒度にも適用可能である。たとえば、売り手側ユニットをより細かいメンバーセッションに、買い手側ユニットをより粗い広告主に設定するのは一般的である。

市場に N 人のメンバーと M 本のキャンペーンがあるとし、それぞれを i \in [N]=\{1,2,\ldots,N\} と C_j,\ j \in [M]=\{1,2,\ldots,M\} で表す。第 j キャンペーン C_j について、予算を B_j \ge 0、ターゲット母集団（メンバー集合）を I_j \subset [N] とする。すべてのキャンペーンの予算を B=\{B_1,B_2,\ldots,B_M\} と記す。ターゲティングはメンバー単位で行われる点に注意する。したがって、あるメンバーがあるキャンペーンにターゲットされているなら、そのメンバーが生成するすべてのリクエストがターゲットされる。さらに、キャンペーンには入札戦略やペーシング戦略など、さまざまな戦略や挙動の違いがあり得る。これらの詳細はモデル化せず、撹乱要因としてパラメータ \Theta_j によって表す。以上の記法のもと、OAM 全体を
\mathcal{M}=\{(C_j, I_j, B_j, \Theta_j)\}_{j=1}^{M}
と表す。図1は OAM の概略図である。

OAM における実験は、新機能が導入される市場サイドによって2種類に分類される。機能が売り手側に作用する場合（例：広告の掲載位置をページ上部から右レールに変更する）、メンバーレベル実験（ME）、すなわち売り手側実験を行い、無作為化ユニットはメンバーとなる。同様に、機能が買い手側に作用する場合（例：キャンペーンの入札価格を調整する）、キャンペーンレベル実験（CE）、すなわち買い手側実験を行い、無作為化ユニットはキャンペーンとなる。

本論文では、まず ME を用いてアイデアを導入する。我々が提案する予算分割（budget-split）デザインは CE にも適用可能である。説明を簡潔にするため、CE の議論は §3.1 に後回しにし、ここでは ME に焦点を当てる。ME において、メンバー i が受ける処置を W_i \in \{0,1\}、すべてのメンバーの処置割当ベクトルを W=(W_1,\ldots,W_N) とする。完全無作為化デザインのような古典的デザインは、売り手側にそのまま適用できる：

定義 1（メンバーレベル完全無作為化デザイン）

メンバーレベル完全無作為化デザインとは、\{0,1\}^N 上の確率分布 \eta であって、ある 1 \le N_1 \le N に対し、\sum_{i=1}^{N} W_i = N_1 のとき \eta(W)=1、それ以外のとき \eta(W)=0 となるものである。〔原文表記のまま〕
（要するに、N 人のうちちょうど N_1 人を処置群に割り付けるデザインです。）

残念ながら、本論文の §2.2 および §5.2 で示すように、買い手側を無視してこのデザインを OAM にそのまま適用すると、処置効果の推定に深刻なバイアスが生じうる。買い手側に古典的デザインを適用して売り手側を無視した場合にも、同様のバイアスが生じる。

<img width="445" height="435" alt="image" src="https://github.com/user-attachments/assets/5c39b391-ed6c-4dcd-bb15-020c1caecefc" />

図1： オンライン広告マーケットプレイスの概略図。各キャンペーンのブロックの大きさは、その予算を表す。

## 2.1 Potential outcomes and causal estimands

翻訳

我々は因果推論に 潜在アウトカム枠組み（Rubin, 1974）を採用する。各 i \in [N] と j \in [M] について、処置割当ベクトル W と予算 B が与えられたときの、メンバー i とキャンペーン C_j に対するスカラーの潜在アウトカムを Y_{ij}(W; B) とする。潜在アウトカムは各（メンバー，キャンペーン）の組ごとに定義されており、これは本デザインでの最も細かい粒度である。類似の設定は Basse et al. (2016b) でも検討されている。

この一般的な設定により、より粗いレベルで測定されたアウトカムは 集約（aggregation） として記述できる。例えば、Doudchenko et al. (2020) や Pouget-Abadie et al. (2019) のように、潜在アウトカムが市場の片側のみの観点で定義されている状況では、他方について Y_{ij}(W; B) の添字で総和を取ることで定義できる。

W_{-i} を、W から第 i 成分を除いた長さ (N-1) のベクトルとする。Chin (2018) に従い、潜在アウトカムの別のパラメータ化 Y_{ij}(W; B) = Y_{ij}(W_i, W_{-i}; B) も考える。

オンライン広告マーケットプレイス（OAM）では、特に 広告主に提供された価値 と マーケットプレイス運営者が受け取る収益 の 2 つの指標に焦点を当てる。具体的には、メンバー i によって生成された広告リクエストによってキャンペーン C_j（実際にはその背後の広告主）に提供された価値を Y_{ij}(W; B) \ge 0 とする。もし i \notin I_j なら、メンバー i は C_j のターゲット母集団に属さず、定義により Y_{ij}(W; B) = 0 である。
〔訳注〕 原文は「i \in I_j ならターゲットでない」となっているが文脈上の誤記と思われるため「i \notin I_j」に訂正して訳した。

一方、i \in I_j の場合、C_j は i \in I_{j’} を満たすすべての他キャンペーン C_{j’} とともに、第一価格オークションや 拡張セカンドプライス（GSP）（Edelman et al., 2007）などのオークションに参加し、メンバー i の訪問に伴う広告枠をめぐって競合する。
〔訳注〕 原文の “firce price auction” は “first-price auction” の誤記と判断。

潜在アウトカムはキャンペーンの予算に依存する点に注意。OAM では、各 C_j の自前の予算 B_j は、システムが ペーシング や 入札戦略（Agarwal et al., 2014）をガイドするために用いられ、各 Y_{ij} の基礎となる当該キャンペーンの入札に影響する。同時に、結果としての Y_{ij} は他キャンペーンの入札にも依存し、それらの入札はそれぞれの予算や実際の支出によって決まる。Basse et al. (2016b) と異なり、本研究では一般性のため、基礎となる入札やオークション機構そのものは追わず、オークションの結果としてのアウトカムに直接着目する。

j \in [M] について、処置割当ベクトル W と予算 B が与えられたときの、メンバー i とキャンペーン C_j に対するスカラーの潜在アウトカムを Y_{ij}(W; B) とする。潜在アウトカムは各（メンバー，キャンペーン）組に対して定義されており、これは本デザインにおける最も細かい粒度である。類似の設定は Basse et al. (2016b) でも検討されている。この一般的な設定により、より粗いレベルで測定されたアウトカムは集約として表現できる。例えば、Doudchenko et al. (2020) や Pouget-Abadie et al. (2019) のように潜在アウトカムが市場の片側だけで定義されている場合でも、他方について Y_{ij}(W; B) の添字で総和を取ることで定義できる。W_{-i} を、W から第 i 成分を除いた (N-1) 次元ベクトルとすると、Chin (2018) に従って潜在アウトカムの別のパラメータ化
Y_{ij}(W; B) = Y_{ij}(W_i, W_{-i}; B)
も考える。

OAM で特に関心のある 2 つの指標に焦点を当てる。すなわち、広告主に提供された価値と、マーケットプレイス運営者が受け取る収益である。具体的には、メンバー i によって生成された広告リクエストによってキャンペーン C_j（実際にはその背後の広告主）に提供された価値を Y_{ij}(W; B) \ge 0 とする。もし i \notin I_j なら、メンバー i は C_j のターゲット母集団には属さず、定義により Y_{ij}(W; B)=0 である。〔訳注：原文は i \in I_j とあるが文脈と矛盾するため誤記と判断し i \notin I_j とした。〕一方、i \in I_j のとき、C_j は i \in I_{j’} を満たすすべての他キャンペーン C_{j’} とともに、たとえば第一価格オークションや拡張セカンドプライス（GSP）（Edelman et al., 2007）といったオークションに参加して、メンバー i の訪問に伴う広告枠をめぐって競合する。〔訳注：原文 “firce price auction” は “first-price auction” の誤記とみなした。〕

潜在アウトカムはキャンペーン予算に依存することに注意。OAM では、C_j 自身の予算 B_j はシステムによってペーシングや入札戦略（Agarwal et al., 2014）をガイドするために用いられ、各 Y_{ij} の基礎となる自キャンペーンの入札に影響する。同時に、得られる Y_{ij} は他キャンペーンの入札にも依存し、これらの入札はそれぞれの予算や実際の支出によって決まる。Basse et al. (2016b) と異なり、本研究では一般性のため、基礎となる入札やオークション機構そのものは追わず、オークションの結果としてのアウトカムに直接着目する。

広告主への提供価値とは別に、対応するマーケットプレイス運営者の収益も重要であり、これを \(Y^{\}_{ij}(W; B)\) と表す。\(Y^{\}{ij}(W; B)\) は Y{ij}(W; B) と等しい場合も等しくない場合もある点は注目に値する。内部の複雑な最適化手続きのため、Y_{ij} の B への依存は「厳密」ではなく、\sum_{i \in I_j} Y_{ij}(W; B) > B_j が起こり得る。これは**過配信（over-delivery）**と呼ばれる現象である。他方、プラットフォームはキャンペーンに対して、その予算を超える額を請求することはできない。したがって各 j について
\[
0 \le Y^{\}{ij}(W; B) \le Y{ij}(W; B), \qquad
\sum_{i \in I_j} Y^{\}_{ij}(W; B) \le B_j. \tag{2.1}
\]

本研究では、潜在アウトカムに条件づけ、処置割当のみをランダム性の源とみなして推論を行う。このランダム化に基づく推論は、Y_{ij}(W; B) に関するモデリング仮定を一切要しないという利点がある。OAM の生態系は複雑で進化し続けるため、これらの潜在アウトカムをモデル化するのは極めて難しいことが多い。

我々は、予算 B に条件づけた総提供価値と総受領収益に関する処置効果を推定したい：
\tau(B) = \sum_{j \in [M]} \sum_{i \in I_j} \big[ Y_{ij}(\mathbf{1}; B) - Y_{ij}(\mathbf{0}; B) \big]
= \sum_{j \in [M]} \tau_j(B),
\[
\tau^{\}(B) = \sum_{j \in [M]} \sum_{i \in I_j} \big[ Y^{\}{ij}(\mathbf{1}; B) - Y^{\*}{ij}(\mathbf{0}; B) \big]
= \sum_{j \in [M]} \tau^{\*}_j(B), \tag{2.2}
\]
ここで \mathbf{1}=(1,1,\ldots,1)_N と \mathbf{0}=(0,0,\ldots,0)_N は、それぞれ全員処置と全員対照の割当ベクトルを表す。

通常の A/B テストの妥当性は、安定単位処置値仮定（SUTVA）（Imbens and Rubin, 2015）に重大に依拠している。SUTVA は、(i) 各処置バリアントの形は一意であり、(ii) あるユニットの潜在アウトカムは他ユニットの処置割当の影響を受けない、という二点から成る。ところが、無干渉の仮定は、キャンペーン予算が限られているため、マーケットプレイスの実験では通常破られる。SUTVA が正当化できる特殊な状況として、予算制約が存在しない仮想世界がある。このとき、各キャンペーンは、当該メンバーの価値に関する自らの評価にもとづいて、ターゲットしている任意のメンバーに自由に入札できる。これは本質的に、Basse et al. (2016b) が置いた 入札に関する SUTVA（SUTVA for bids） の仮定である。形式的には次のようになる。

仮定 1（無制限予算下の無干渉）. すべての j \in [M] について B_j=\infty ならば、
Y_{ij}(W;\infty)=Y_{ij}(W_i;\infty)
が成り立つ。このとき、次の単純なプラグイン推定量は不偏である：
\hat{\tau}j(\infty)
= \sum{i\in I_j} \frac{W_i\, Y_{ij}(W;\infty)}{N_1/N}
\;-\;
\sum_{i\in I_j} \frac{(1-W_i)\, Y_{ij}(W;\infty)}{N_0/N},
\tag{2.3}
ここで N_1=\sum_{i=1}^{N} W_i, N_0=N-N_1 である。さらに、予算制約がないため \(Y^{\}{ij}(W)=Y{ij}(W)=Y_{ij}(W_i)\) が成り立ち、対応する \(\tau^{\}_j(\infty)\) のプラグイン推定量 \(\hat{\tau}^{\*}_j(\infty)\) も不偏である。

〔訳注1〕原文 “SUTVA at can be justified” は “SUTVA can be justified” の誤記と判断。
〔訳注2〕原文 “N_1=\sum_{i=1}^{N} w_i” は文脈上 W_i の誤記と判断。
〔訳注3〕式 (2.3) は分母が N_1/N, N_0/N の 平均差（逆確率重み）形式と読めるため、分数として明示した。

## 2.2 Finite budget and the cannibalization bias

現実には、広告キャンペーンの予算が無制限であることは非常に起こりにくい。その結果、仮定1は成立せず、潜在アウトカムは影響を受ける。予算が有限であると、各キャンペーンは自らのターゲット全体を見渡した、より「グローバル」な観点から入札を計画し、総予算を各メンバーに賢く分配する必要がある。たとえば、処置（treatment）が対照（control）より優位であれば、賢明なキャンペーンはこの利点を活かして処置群のメンバーにより多くの予算を配分し、その結果、潜在アウトカム間に干渉が生じる。この干渉のため、(2.3) のような素朴な推定量は、\tau_j(B) および \(\tau^{\*}_j(B)\) に対してもはや不偏ではない。

これをさらに明確にするため、2つの例を考える。第1の例は、厳密な予算制約ゆえに実際の OAM で起こり得るごく一般的な状況において、\(\tau^{\}_j(B)\) の素朴推定量 \(\hat{\tau}^{\}_j(B)\) がバイアスを持つことを示す。第2の例は、より基本的なケースとして、\hat{\tau}_j(B) さえもバイアスを持つことを示す。以後、各キャンペーン j \in [M] について 0 < B_j < \infty と仮定する。

例 1（予算の完全消化）

単一の買い手が 100ドルの予算を持ち、1インプレッションあたり20ドルで売り手の注意（attention）を購入したいとする。また、売り手は多数いて、それぞれが買い手の広告に注意を払う傾向（propensity）が異なるとする。マーケットプレイスは、買い手と、買い手の広告に最も関心の高い売り手をよりうまくマッチングするためのアルゴリズムを改善することが自然である。もし買い手が劣った売り手ランキングの下でもすでに 100ドルの予算を使い切っている（\(\sum_{i \in [N]} Y^{\}{i1}(0; 100) = 100\)）なら、ランキングを改善しても、使える予算が残っていないため買い手の支出をさらに増やすことはできない（定義より \(\sum{i \in [N]} Y^{\}_{i1}(1; 100) \le 100\) であり、\(\tau^{\*}_1(100) \le 0\)）。
一方で、メンバーレベル完全無作為化実験を実施し、処置群の売り手をより良いアルゴリズムでランキングしたなら、プラグイン推定量はその改良アルゴリズムの正の処置効果を観測してしまうだろう。

例 2（逓減収益を伴う普遍的に有益な処置）

あるキャンペーン j について I_j = [N] とし、任意の i \in [N] に対して次が成り立つとする：

Y_{ij}(0,\,|W_{-i}| = N - 1; B) \;<\; \cdots \;<\; Y_{ij}(0,\,|W_{-i}| = 1; B) \;<\; Y_{ij}(0, 0; B)
<\; Y_{ij}(1, 1; B) \;<\; Y_{ij}(1,\,|W_{-i}| = N - 2; B) \;<\; \cdots \;<\; Y_{ij}(1,\,|W_{-i}| = 0; B). \tag{2.4}

ここで 0 \le K < N に対し、
Y_{ij}(W_i,\,|W_{-i}| = K; B) = \{\, Y_{ij}(W_i, W_{-i}; B) : \textstyle\sum_{i \in I_j} W_{-i} = K \,\}
とする。直感的には、この状況では処置は各メンバーの価値を押し上げる。しかし、処置群のサイズが小さいほど処置群メンバーはより価値が高く、処置群のサイズが大きいほど対照群メンバーの価値は低くなる（郡の労働市場への類推を考えてみよう。大卒が1人しかいなければその人の賃金は高いが、大卒が増えるにつれ学位の価値は逓減し、高卒だけの人は就職すら難しくなる）。

このとき、

\begin{aligned}
\mathbb{E}[\hat{\tau}j(B)] - \tau_j(B)
&= \Bigg\{\mathbb{E}\!\left[\sum{i=1}^{N} \frac{W_i \cdot Y_{ij}\big(1,\,|W_{-i}| = N_1 - 1;\, B\big)}{N_1/N}\right]
	•	\sum_{i=1}^{N} Y_{ij}(1, 1; B)\Bigg\} \\
&\quad + \Bigg\{\sum_{i=1}^{N} Y_{ij}(0, 0; B)
	•	\mathbb{E}\!\left[\sum_{i=1}^{N} \frac{(1 - W_i) \cdot Y_{ij}\big(0,\,|W_{-i}| = N_0 - 1;\, B\big)}{N_0/N}\right]\Bigg\}. \tag{2.5}
\end{aligned}

右辺の2つの項はいずれも正である（(2.4) より）。したがって、\hat{\tau}_j(B) は正のバイアスを持つ。

(2.5) においては、\sum_{i=1}^{N} Y_{ij}(1, 1; B) は過大評価され、\sum_{i=1}^{N} Y_{ij}(0, 0; B) は過小評価される。ゆえに我々は、この素朴推定量のバイアスをカニバリゼーション・バイアスと呼ぶ。すなわち、新バージョンの製品が実験内で優位に見えるのは、処置群メンバーの価値を上積みするだけでなく、対照群メンバーの価値を**“食ってしまう”**（cannibalize）ためでもあるからだ。


## 2.3 Switchback design

# 3 Budget-split design

## 3.1 Campaign-level experiments

# 4 System Architecture

<img width="638" height="359" alt="image" src="https://github.com/user-attachments/assets/14f78e74-8542-42e3-8ae5-b26a3bf252e7" />


# 5 Empirical Results

## 5.1 Power Gain

## 5.2 Robustness against Cannibalization Bias

# 6 Discussions

# Acknowledgements



